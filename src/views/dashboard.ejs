<!-- src/views/dashboard.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Zuxton</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="/css/styles.css" rel="stylesheet">
    <link href="/css/nodeRunner.css" rel="stylesheet">
    <!-- Load TON Connect UI first -->
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js?v=2"></script>
    
</head>
<body class="bg-[#0B1024] text-white">
    <div class="min-h-screen">
        <!-- Navigation -->
<nav class="fixed top-0 w-full z-50 bg-[#0F172A] border-b border-[#29A5F8]/10 backdrop-blur-md">
    <div class="container mx-auto px-6 py-4">
        <div class="flex justify-between items-center">
            <!-- Logo with animated gradient -->
            <h1 class="text-2xl font-black tracking-tight">
                <span class="animate-gradient bg-gradient-to-r from-[#29A5F8] via-[#2983F8] to-[#29CCF8] bg-clip-text text-transparent">
                    Zuxton
                </span>
            </h1>
            
            <!-- Wallet Connect Button -->
            <div class="flex items-center space-x-4">
                <!-- Optional: Add navigation items here -->
                <div id="ton-connect"></div>
            </div>
        </div>
    </div>
 </nav>
 
 <!-- Spacer to prevent content from going under fixed navbar -->
 <div class="h-[72px]"></div>

        <!-- Dashboard Content -->
        <main class="container mx-auto px-6 py-8">
            <!-- Add this section after validator status card in dashboard.ejs -->
            <div class="premium-card p-6 mb-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                    <h2 class="text-xl font-bold gradient-text mb-2 md:mb-0">Node Runner</h2>
                    <div id="nodeStatus" class="status-badge running">Not Running</div>
                </div>
            
                <!-- Animation Steps - Now more compact on mobile -->
                <div id="animation-steps" class="premium-card p-4 mb-4 hidden">
                    <div id="checking-connection-step" class="flex items-center space-x-3 mb-2">
                        <div class="w-3 h-3"></div>
                        <span class="text-sm text-gray-400">Checking Connection</span>
                    </div>
                    <div id="request-pool-step" class="flex items-center space-x-3 mb-2">
                        <div class="w-3 h-3"></div>
                        <span class="text-sm text-gray-400">Request to Node Pool</span>
                    </div>
                    <div id="smart-contract-step" class="flex items-center space-x-3">
                        <div class="w-3 h-3"></div>
                        <span class="text-sm text-gray-400">PoC Contract Execution</span>
                    </div>
                </div>
            
                <!-- Statistics Grid - Responsive -->
                <div class="stats-grid">
                    <!-- Today's Stats -->
                    <div class="stats-item">
                        <h3 class="text-sm font-semibold text-gray-400 mb-3">Today's Statistics</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Nodes Validated</span>
                                <span id="todayNodes" class="text-[#29A5F8] font-semibold">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Points Earned</span>
                                <span id="todayPoints" class="text-[#29A5F8] font-semibold">0.0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Running Time</span>
                                <span id="runningTime" class="time-display">00:00:00</span>
                            </div>
                        </div>
                    </div>
            
                    <!-- Total Stats -->
                    <div class="stats-item">
                        <h3 class="text-sm font-semibold text-gray-400 mb-3">Total Statistics</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Total Nodes</span>
                                <span id="totalNodes" class="text-[#29A5F8] font-semibold">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Total Points</span>
                                <span id="totalPoints" class="text-[#29A5F8] font-semibold">0.0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Total Hours</span>
                                <span id="totalHours" class="time-display">0h</span>
                            </div>
                        </div>
                    </div>
                </div>
            
                <!-- Control Buttons -->
                <div class="flex justify-center mt-6 space-x-4">
                    <button id="runNodeBtn" class="btn-premium">
                        Run Node
                    </button>
                    <button id="stopNodeBtn" class="btn-premium bg-gradient-to-r from-red-500 to-red-600 hidden">
                        Stop Node
                    </button>
                </div>
            
                <!-- Status Message -->
                <div id="nodeMessages" class="mt-4 text-center hidden">
                    <p id="statusMessage" class="text-sm gradient-text"></p>
                </div>
            </div>
            <!-- Validator Status Card -->
<div class="premium-card p-6 mb-6">
    <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold gradient-text">Proof of Contribution Status</h2>
        <div id="validatorStatus" class="status-badge"></div>
    </div>
 
    <!-- Info Panel -->
    <div class="bg-[#1A2235] rounded-lg p-4 mb-4 border border-[#29A5F8]/10">
        <p class="text-gray-400 text-sm leading-relaxed">
            The Proof of Contribution (PoC) is a decentralized mechanism that establishes validator eligibility through a smart contract interaction. This process is designed to enhance security, verify commitment, and ensure that validators align with Zuxton's principles of decentralized integrity. By completing PoC, you unlock full access to node validation capabilities within the ecosystem.
        </p>
    </div>
 
    <div class="space-y-4">
        <!-- Status & Action -->
        <div class="flex items-center justify-between">
            <span id="validatorStatusText" class="text-gray-400 font-medium"></span>
            <button id="becomeValidatorBtn" 
                    onclick="handleBecomeValidator()"
                    class="btn-premium">
                    Sign PoC Contract
            </button>
        </div>
 
        <!-- PoC Info -->
        <div id="txInfo" class="hidden">
            <p class="text-[#29A5F8] text-sm font-semibold mb-2">PoC SecretKey:</p>
            <div class="premium-card bg-[#1A2235]/80 p-4 rounded-lg">
                <div id="txHash" class="font-mono text-sm text-gray-300 break-all"></div>
            </div>
        </div>
    </div>
 </div>

            <!-- Referral Card -->
            <div class="premium-card p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold gradient-text">Referral Program</h2>
                    <div class="px-4 py-1 rounded-full text-sm bg-[#1A2235]">
                        <span class="text-gray-400">Total Referrals: </span>
                        <span id="totalReferrals" class="text-[#29A5F8]">0</span>
                    </div>
                </div>
            
                <div class="space-y-4">
                    <div class="relative">
                        <input type="text" 
                               id="referralLink" 
                               readonly 
                               class="w-full bg-[#1A2235] rounded-lg py-3 pl-4 pr-12 text-gray-300 font-mono text-sm"
                               value="">
                        <button onclick="copyReferralLink()" 
                                class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-[#29A5F8] transition-colors">
                            <svg id="copyIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                            </svg>
                            <svg id="checkIcon" class="w-5 h-5 hidden text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            
                <!-- Referrals List -->
                <div class="mt-6 overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400">
                                <th class="pb-4">Wallet</th>
                                <th class="pb-4">Joined Date</th>
                            </tr>
                        </thead>
                        <tbody id="referralsList" class="text-truncate">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            </div>
        </main>
    </div>

    <!-- Premium Footer -->
<footer class="bg-[#0F172A] border-t border-[#29A5F8]/10 mt-12">
    <div class="container mx-auto px-6 py-8">
        <!-- Main Footer Content -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
            <!-- Brand Section -->
            <div class="col-span-1">
                <h3 class="text-2xl font-black mb-4">
                    <span class="animate-gradient bg-gradient-to-r from-[#29A5F8] via-[#2983F8] to-[#29CCF8] bg-clip-text text-transparent">
                        Zuxton
                    </span>
                </h3>
                <p class="text-gray-400 text-sm mb-4">
                    Empowering decentralized validation through innovative node running solutions.
                </p>
                <div class="flex space-x-4">
                    <!-- Social Links -->
                    <a href="#" class="text-gray-400 hover:text-[#29A5F8] transition-colors">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/>
                        </svg>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-[#29A5F8] transition-colors">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 0C5.374 0 0 5.374 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.626-5.374-12-12-12z"/>
                        </svg>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-[#29A5F8] transition-colors">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </a>
                </div>
            </div>
 
            <!-- Products -->
            <div class="col-span-1">
                <h4 class="text-white font-semibold mb-4">Products</h4>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Node Runner</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Validator Program</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Referral System</a></li>
                </ul>
            </div>
 
            <!-- Resources -->
            <div class="col-span-1">
                <h4 class="text-white font-semibold mb-4">Resources</h4>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Documentation</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">API Reference</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Community</a></li>
                </ul>
            </div>
 
            <!-- Company -->
            <div class="col-span-1">
                <h4 class="text-white font-semibold mb-4">Company</h4>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">About Us</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Blog</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Contact</a></li>
                </ul>
            </div>
        </div>
 
        <!-- Bottom Footer -->
        <div class="border-t border-[#29A5F8]/10 pt-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="text-gray-400 text-sm mb-4 md:mb-0">
                    © 2024 Zuxton. All rights reserved.
                </div>
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Privacy Policy</a>
                    <a href="#" class="text-gray-400 hover:text-[#29A5F8] text-sm transition-colors">Terms of Service</a>
                </div>
            </div>
        </div>
    </div>
 </footer>

    <!-- Load dashboard.js after DOM content -->
    <script src="/js/nodeRunner.js"></script>
    <script>
        // Initialize tooltips or other UI elements if needed
        document.addEventListener('DOMContentLoaded', function() {
            // Check if validator is active
            const validatorStatus = document.getElementById('validatorStatus');
            const nodeRunnerSection = document.getElementById('nodeRunnerSection');
            
            if (validatorStatus && validatorStatus.textContent.includes('Not Active')) {
                const runNodeBtn = document.getElementById('runNodeBtn');
                if (runNodeBtn) {
                    runNodeBtn.disabled = true;
                    runNodeBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    runNodeBtn.title = 'Become a validator first';
                }
            }
        });
    </script>
    <script src="/js/dashboard.js"></script>
    <script src="/js/scrol.js"></script>
</body>
</html>